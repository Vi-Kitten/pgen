# pgen
A PEG tokenizer/parser-generator.

This is the program that generates the tokenizer and parser for the [Daisho](https://github.com/apaz-cli/Daisho)
programming language. Right now, it's a WIP. The project is not usable.

The syntax of pgen is based on the paper ["Parsing Expression Grammars: A Recognition-Based Syntactic Foundation"](https://bford.info/pub/lang/peg.pdf)
by [Bryan Ford](https://scholar.google.com/citations?hl=en&user=TwyzQP4AAAAJ).
It's inspired by [packcc](https://github.com/arithy/packcc) by [Arihiro Yoshida](https://github.com/arithy).
However, its purpose is completely different.

The one difference is that peg grammars like the ones you would
write for `packcc` operate on individual characters of the input. For
`pgen`, you define both a tokenizer and a parser. The tokenizer
recognizes and groups together sequences of characters into tokens.
It uses the [maximal munch](https://en.wikipedia.org/wiki/Maximal_munch)
heuristic and throws an error if there are ambiguities. Then the parser
strings together the token stream coming from the tokenizer into an
[abstract syntax tree](https://en.wikipedia.org/wiki/Abstract_syntax_tree).

The other difference is that unlike other parser-generators such as
`yacc` or `packcc`, `pgen` doesn't hide the fact that it's a virtual
machine, and arguably its own programming language. Embracing this fact
opens up the ability to effortlessly generate Abstract Syntax Trees.


## Roadmap

- [x] Completed `pgen` grammar for `pgen`
- [ ] Shared symbol table code
- [ ] Handwritten tokenizer for `pgen`
- [ ] Handwritten parser for `pgen`
- [ ] Symbol table generation
- [ ] Tokenizer code generation from symtab
- [ ] Parser code generation from symtab
- [ ] `pgen` can parse and generate itself
- [ ] `pgen` is self-hosting


## Tips on writing tokenizers and grammars

This section is TODO.

* While pgen solves the grammar production determinism problem with its abstract machine, it does not excempt
the user from thinking about the problem. Otherwise, it may just do the wrong thing every time.



## License

The code and a binary for `packcc` are included in this repo, but are not a part of the final `pgen`
executable or code generated by `pgen`. Packcc is public domain (to the extent allowable by law). See
the main repo ([https://github.com/arithy/packcc](https://github.com/arithy/packcc)) and PPC_LICENSE for
details.

The license for `pgen` is GPLv3. The license applies only to the files already in this repository (other
than `packcc.c` and `packcc`). The license for the code generated by `pgen` is the license of the grammar
that it was generated from. For example, since the parser for `pgen` is itself generated from `pgen.peg`
which is GPLv3, the resulting `pgen.h` from running `pgen pgen.peg` is also GPLv3. If `pgen.peg` were MIT
licensed, then `pgen.h` would be MIT licensed as well. If you write a grammar, you own the code that
`pgen` generates from it. But if you modify `pgen` itself and distribute it, it has to be released under
GPLv3.

If these terms are not acceptable for you, please contact me with your use case.

