#!/bin/sh

# Generate utf8 include with xxd
xxd -i src/utf8.h | sed 's/\([0-9a-f]\)$/\0, 0x00/' > src/strutf8.xxd

# Build pgen
rm pgen examples/pl0.h 2>/dev/null
clang src/pgen.c -o pgen -fsanitize=address -g -Wall -Wextra -Wpedantic -Wno-unused-parameter -Wno-unused-variable
./pgen examples/pl0.tok examples/pl0.peg -o examples/pl0.h

# Run pl0 example.
cd examples/
clang pl0.c -fsanitize=address -g
./a.out | head -n 50
cd ..
